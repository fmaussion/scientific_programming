
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>01 - Modules, import mechanism, namespaces, scope(s) &#8212; Scientific Programming</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="02 - String formatting and file paths" href="02-Strings-Paths.html" />
    <link rel="prev" title="Assignment #02" href="../week_02/Assignment-02.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-88391345-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Scientific Programming</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../welcome.html">
   Welcome
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../faq.html">
   Frequently Asked  Questions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   External resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../slides.html">
   Presentation slides
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 01 - Linux &amp; Python primer
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_01/01-Linux.html">
   01 - A very short introduction to Linux
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_01/02-Installation.html">
   02 - Installing Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_01/03-Getting-Started.html">
   03 - Getting started with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_01/Assignment-01.html">
   Assignment #01
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 02 - Python language fundamentals
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_02/01-Language-Fundamentals.html">
   01 - Language fundamentals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_02/Assignment-02.html">
   Assignment #02
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 03 - Variables scopes, modules, strings, good practices
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   01 - Modules, import mechanism, namespaces, scope(s)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-Strings-Paths.html">
   02 - String formatting and file paths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-Tips-and-Tricks.html">
   03 - Tips and tricks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-Good-practices.html">
   04 - Good practices, programming style and conventions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Assignment-03.html">
   Assignment #03
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 04 - Floating point arithmetics, Numpy basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_04/01-Why-Numpy.html">
   01 - Introduction to numpy: why does numpy exist?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_04/02-Numbers.html">
   02 - Number representation in computers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_04/Assignment-04.html">
   Assignment #04
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 05 - Scientific Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_05/01-Numpy-ndarrays.html">
   01 - Arrays in numpy: indexing, ufuncs, broadcasting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_05/02-Scientific-Python.html">
   02 - The scientific python stack
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_05/Assignment-05.html">
   Assignment #05
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 06 - Testing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_06/01-Exceptions.html">
   01 - Errors, Exceptions and Warnings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_06/02-Testing.html">
   02 - Testing your code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_06/Assignment-06.html">
   Assignment #06: exceptions and testing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 07 - Python Packages and ClimVis project
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_07/01-Package-structure.html">
   01 - Structure of a python package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_07/02-ClimVis.html">
   Term project: the ClimVis package
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 08 - Revisions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_08/01-revisions.html">
   01 - Revisions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_08/02-optional-exercise.html">
   Optional exercise
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 09 - Code documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_09/01-Documentation.html">
   01 - Documenting your code
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/week_03/01-Import-Scopes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/fmaussion/scientific_programming"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/fmaussion/scientific_programming/issues/new?title=Issue%20on%20page%20%2Fweek_03/01-Import-Scopes.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/fmaussion/scientific_programming/edit/master/book/week_03/01-Import-Scopes.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/fmaussion/scientific_programming/master?urlpath=lab/tree/book/week_03/01-Import-Scopes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variable-scopes">
   Variable scopes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modules">
   Modules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#namespaces">
   Namespaces
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sys-path">
   sys.path
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reimporting-modules">
   Reimporting modules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#executing-modules-as-scripts">
   Executing modules as scripts
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#take-home-points">
   Take home points
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="modules-import-mechanism-namespaces-scope-s">
<h1>01 - Modules, import mechanism, namespaces, scope(s)<a class="headerlink" href="#modules-import-mechanism-namespaces-scope-s" title="Permalink to this headline">¶</a></h1>
<p>In this chapter we will dive into one of the most important features of python: the <code class="docutils literal notranslate"><span class="pre">import</span></code> mechanism. We will explain why modules are useful, how to “import” them, and how you can write one yourself.</p>
<div class="section" id="variable-scopes">
<h2>Variable scopes<a class="headerlink" href="#variable-scopes" title="Permalink to this headline">¶</a></h2>
<p>The <strong>scope</strong> of a variable is the region of the program where the variable is valid, i.e. the “location” where the variable name can be used to refer to the data it links to. Let’s consider this first example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;in foo()&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;global&#39;</span><span class="p">)</span>  <span class="c1"># will throw an error</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_112631</span><span class="o">/</span><span class="mf">1305398920.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;in foo()&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;global&#39;</span><span class="p">)</span>  <span class="c1"># will throw an error</span>

<span class="ne">NameError</span>: name &#39;i&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>It doesn’t work because the name <code class="docutils literal notranslate"><span class="pre">i</span></code> is defined in the function <code class="docutils literal notranslate"><span class="pre">foo</span></code>, which we defined but never called (you can see this because nothing is printed), so the function’s statements were actually never run.</p>
<p>Let’s see if the following example works better:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;in foo()&#39;</span><span class="p">)</span>

<span class="n">foo</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;global&#39;</span><span class="p">)</span>   <span class="c1"># will throw an error</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5 in foo()
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_112631</span><span class="o">/</span><span class="mf">623095965.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">foo</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> 
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;global&#39;</span><span class="p">)</span>   <span class="c1"># will throw an error</span>

<span class="ne">NameError</span>: name &#39;i&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Here, the function is called and <code class="docutils literal notranslate"><span class="pre">i</span></code> is defined and equal to 5. However, the <em>scope</em> of the variable <code class="docutils literal notranslate"><span class="pre">i</span></code> is the block defined by the function <code class="docutils literal notranslate"><span class="pre">foo</span></code>: outside of this scope the variable doesn’t exist anymore, leading to the <code class="docutils literal notranslate"><span class="pre">NameError</span></code> at the global scope.</p>
<p>If this is understood, the following example might be clear as well?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;in foo()&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;global before foo()&#39;</span><span class="p">)</span>

<span class="n">foo</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;global after foo()&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 global before foo()
5 in foo()
1 global after foo()
</pre></div>
</div>
</div>
</div>
<p>The <strong>global scope</strong> refers to the highest scope level (the module or, in interactive mode, the interpreter). The function’s scope in turn is called <strong>local scope</strong>. One says that the global scope prevails because what is possible in one direction isn’t possible in the other:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;is there a k in foo()?&#39;</span><span class="p">)</span>

<span class="n">foo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 is there a k in foo()?
</pre></div>
</div>
</div>
</div>
<p>Yes, <code class="docutils literal notranslate"><span class="pre">k</span></code> is available in <code class="docutils literal notranslate"><span class="pre">foo()</span></code>: global variables are <em>also</em> available in the <em>nested</em> local scopes. They can be overridden locally (like in the example above), but this change won’t be visible at the global scope level.</p>
<div class="exercise admonition" id="week_03/01-Import-Scopes-exercise-0">
<p class="admonition-title"><span class="caption-number">Exercise 8 </span></p>
<div class="section" id="exercise-content">
<p>Do you think there is a way to really overwrite the value of a global variable from a local scope? If yes, can you find it and try it by yourself?</p>
</div>
</div></div>
<div class="section" id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<p>Python <strong>modules</strong> are used to store a collection of functions and variables that can be imported into other modules or into the <a class="reference external" href="https://docs.python.org/3/library/__main__.html">main environment</a>.</p>
<p>A module is a file containing Python definitions and statements. The file name is the module name with the suffix <code class="docutils literal notranslate"><span class="pre">.py</span></code> appended.</p>
<p>For instance, I used my favorite text editor to create a file called <code class="docutils literal notranslate"><span class="pre">greetings.py</span></code> with the following content:</p>
<p><code class="docutils literal notranslate"><span class="pre">greetings.py:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;A module to say hi in several langages.&quot;&quot;&quot;</span>

<span class="n">base</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;en&#39;</span><span class="p">:</span> <span class="s1">&#39;Hi </span><span class="si">{}</span><span class="s1">!&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fr&#39;</span><span class="p">:</span> <span class="s1">&#39;Salut </span><span class="si">{}</span><span class="s1">!&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cn&#39;</span><span class="p">:</span> <span class="s1">&#39;你好 </span><span class="si">{}</span><span class="s1">!&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">current_language</span> <span class="o">=</span> <span class="s1">&#39;en&#39;</span>


<span class="k">def</span> <span class="nf">say_hi</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Say hi in the current language.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="n">current_language</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">set_current_language</span><span class="p">(</span><span class="n">lang</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set language currently spoken by the module.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">current_language</span>
    <span class="k">if</span> <span class="n">lang</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Language unknown: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lang</span><span class="p">))</span>
    <span class="n">current_language</span> <span class="o">=</span> <span class="n">lang</span>
</pre></div>
</div>
<p>I copied this file in the current <strong>working directory</strong> (this “detail” is important, as we will see below). From the (i)python interpreter I can now import this module with the following command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">greetings</span>
</pre></div>
</div>
</div>
</div>
<p>By importing the module, I have access to the functions it contains:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">greetings</span><span class="o">.</span><span class="n">say_hi</span><span class="p">(</span><span class="s1">&#39;Fabi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hi Fabi!
</pre></div>
</div>
</div>
</div>
<p>But also to the global variables defined at the top level:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">greetings</span><span class="o">.</span><span class="n">base</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;en&#39;: &#39;Hi {}!&#39;, &#39;fr&#39;: &#39;Salut {}!&#39;, &#39;cn&#39;: &#39;你好 {}!&#39;}
</pre></div>
</div>
</div>
</div>
<p>Thanks to the new <code class="docutils literal notranslate"><span class="pre">global</span></code> statement we just discovered, I can change the state of the module’s variables from within a function. For example, I can set the new default language with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">greetings</span><span class="o">.</span><span class="n">set_current_language</span><span class="p">(</span><span class="s1">&#39;cn&#39;</span><span class="p">)</span>
<span class="n">greetings</span><span class="o">.</span><span class="n">say_hi</span><span class="p">(</span><span class="s1">&#39;Jan&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>你好 Jan!
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition" id="week_03/01-Import-Scopes-exercise-1">
<p class="admonition-title"><span class="caption-number">Exercise 9 </span></p>
<div class="section" id="exercise-content">
<p>Repeat the steps above on your laptop and do additional experiments / ask questions until these variable scope mechanisms are well understood.</p>
</div>
</div></div>
<div class="section" id="namespaces">
<h2>Namespaces<a class="headerlink" href="#namespaces" title="Permalink to this headline">¶</a></h2>
<p>Global variables in modules or scripts are useful, but <em>they should be used with care</em>. Indeed, since they are available from everywhere in the module, the <strong>namespace</strong> can quickly become “polluted”: for large modules, it becomes hard to keep track of all variables. This can become even more complicated when new modules with their own new variables and functions are used as well.</p>
<p>Fortunately, the global scope is constrained to the current script or module, and using external modules is unlikely to cause confusion thanks to the <code class="docutils literal notranslate"><span class="pre">import</span></code> mechanism:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pi</span> <span class="o">=</span> <span class="mf">3.14</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;module &#39;math&#39; from &#39;/home/mowglie/.pyenv/versions/3.8.5/lib/python3.8/lib-dynload/math.cpython-38-x86_64-linux-gnu.so&#39;&gt;
3.14 3.141592653589793
</pre></div>
</div>
</div>
</div>
<p>By importing the <code class="docutils literal notranslate"><span class="pre">math</span></code> module (available in python’s <strong>standard library</strong>), we have access to a new variable called <code class="docutils literal notranslate"><span class="pre">math</span></code>. The variable <code class="docutils literal notranslate"><span class="pre">math</span></code> has the type <code class="docutils literal notranslate"><span class="pre">module</span></code>, and provides new functions and variables (such as <code class="docutils literal notranslate"><span class="pre">math.pi</span></code>). What are all these functions and variables? Let’s use the built-in <code class="docutils literal notranslate"><span class="pre">dir()</span></code> function to find out:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">math</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;__doc__&#39;, &#39;__file__&#39;, &#39;__loader__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__spec__&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan&#39;, &#39;atan2&#39;, &#39;atanh&#39;, &#39;ceil&#39;, &#39;comb&#39;, &#39;copysign&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;degrees&#39;, &#39;dist&#39;, &#39;e&#39;, &#39;erf&#39;, &#39;erfc&#39;, &#39;exp&#39;, &#39;expm1&#39;, &#39;fabs&#39;, &#39;factorial&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;frexp&#39;, &#39;fsum&#39;, &#39;gamma&#39;, &#39;gcd&#39;, &#39;hypot&#39;, &#39;inf&#39;, &#39;isclose&#39;, &#39;isfinite&#39;, &#39;isinf&#39;, &#39;isnan&#39;, &#39;isqrt&#39;, &#39;ldexp&#39;, &#39;lgamma&#39;, &#39;log&#39;, &#39;log10&#39;, &#39;log1p&#39;, &#39;log2&#39;, &#39;modf&#39;, &#39;nan&#39;, &#39;perm&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;prod&#39;, &#39;radians&#39;, &#39;remainder&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;tan&#39;, &#39;tanh&#39;, &#39;tau&#39;, &#39;trunc&#39;]
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition" id="week_03/01-Import-Scopes-exercise-2">
<p class="admonition-title"><span class="caption-number">Exercise 10 </span></p>
<div class="section" id="exercise-content">
<p>Ask the ipython documentation about <code class="docutils literal notranslate"><span class="pre">dir</span></code> (remember how?)</p>
</div>
</div><p>Like our <code class="docutils literal notranslate"><span class="pre">greetings</span></code> module, the <code class="docutils literal notranslate"><span class="pre">math</span></code> module contains functions (e.g. <code class="docutils literal notranslate"><span class="pre">math.radians</span></code>) as well as variables (e.g. <code class="docutils literal notranslate"><span class="pre">math.nan</span></code> or <code class="docutils literal notranslate"><span class="pre">math.pi</span></code>). For Python there is no fundamental difference between variables and functions: they are simply all <strong>attributes</strong> of the <code class="docutils literal notranslate"><span class="pre">math</span></code> module and therefore listed by <code class="docutils literal notranslate"><span class="pre">dir</span></code> (we’ll get back to attributes later: for now, remember the dot <code class="docutils literal notranslate"><span class="pre">.</span></code> syntax, <code class="docutils literal notranslate"><span class="pre">dir</span></code> and <code class="docutils literal notranslate"><span class="pre">TAB</span></code> autocompletion). Some of the attributes listed by <code class="docutils literal notranslate"><span class="pre">dir</span></code> have a prefix of two underscores <code class="docutils literal notranslate"><span class="pre">__</span></code>. We’ll get back to them soon.</p>
<p>There are several ways to import a module. See these four examples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A</span>
<span class="c1"># Import an entire module and access its attributes with a &quot;dot&quot;</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># B</span>
<span class="c1"># Same as A, but store the module under a new variable named &quot;ma&quot;</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">ma</span>
<span class="n">ma</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ma</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># C</span>
<span class="c1"># Import the attributes sin and pi *only*</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span>
<span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># D</span>
<span class="c1"># Import everything from the module and add it in our global scope</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>All four options lead to the same result: they compute the sinus of π/2.</p>
<p>Now, which one to use? It is up to you, but there are some implicit rules (conventions) which are widely accepted:</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<ol class="simple">
<li><p>In case of doubt, use option A. It is the most readable and the most <em>explicit</em>.</p></li>
<li><p>The exception to the first rule is when the library has a naming convention for its acronym. A good example is <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, which <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/tutorial/general.html">recommends to use</a> <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code>.</p></li>
<li><p>Option C might be useful if the names you are importing are very explicit, and if you expect to use them often in your script. Otherwise, it is not recommended.</p></li>
<li><p>Option D is bad. Don’t use it.</p></li>
<li><p>You can make an exception to rule 4 when working in the command line and exploring data. Never use option 4 in scripts.</p></li>
</ol>
</div>
<div class="exercise admonition" id="week_03/01-Import-Scopes-exercise-3">
<p class="admonition-title"><span class="caption-number">Exercise 11 </span></p>
<div class="section" id="exercise-content">
<p>Try to find arguments why option D is a bad idea. <strong>If you can’t find any reason, ask me next week</strong>!</p>
</div>
</div></div>
<div class="section" id="sys-path">
<span id="content-syspath"></span><h2>sys.path<a class="headerlink" href="#sys-path" title="Permalink to this headline">¶</a></h2>
<p>But how does python know where to look for modules when you type <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">mymodule</span></code> in the interpreter? Well, it relies on a mechanism very similar to linux’s <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment variable. Remember this one? Within python, the directories where the interpreter will look for modules to import are listed in <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.path">sys.path</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span>

<span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/scratch/c707/c7071047/miniconda3/bin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/scratch/c707/c7071047/miniconda3/lib/python36.zip&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/scratch/c707/c7071047/miniconda3/lib/python3.6&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/scratch/c707/c7071047/miniconda3/lib/python3.6/lib-dynload&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/scratch/c707/c7071047/miniconda3/lib/python3.6/site-packages&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/scratch/c707/c7071047/miniconda3/lib/python3.6/site-packages/cycler-0.10.0-py3.6.egg&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/scratch/c707/c7071047/miniconda3/lib/python3.6/site-packages/IPython/extensions&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/home/c7071047/.ipython&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Similar to the linux <code class="docutils literal notranslate"><span class="pre">PATH</span></code> mechanism, python will look into each of these directories <em>in order</em>. <strong>The first directory is always the current working directory</strong> (an empty string), the rest of the list may vary depending on your environment. When a file called <code class="docutils literal notranslate"><span class="pre">mymodule.py</span></code> is found, it is imported once (and only once) and added to the <code class="docutils literal notranslate"><span class="pre">sys.modules</span></code> variable, effectively telling python that the module has already been imported. <strong>This means that if you change the file and import it again, nothing will change</strong>. Fortunately, there are ways to avoid this behavior (see below).</p>
<p>As you can see, there are many folders related to <code class="docutils literal notranslate"><span class="pre">miniconda</span></code>, the tool we used to install python. This makes sense, because we want python to look for modules related to <em>our</em> installation of python (not the one used by our operating system). In particular, the <code class="docutils literal notranslate"><span class="pre">site-packages</span></code> folder is of interest to us. If you look into this folder using the linux command line or ipython’s magic commands (remember how?) you’ll find the many packages we already installed together last week.</p>
<p>You can edit <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> at your wish and add new folders to it, exactly as you would with the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment variable in linux. In practice, however, it is recommended to use standard folders to install your packages instead of messing around with <code class="docutils literal notranslate"><span class="pre">sys.path</span></code>. I personally never had to change <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> in my scripts, but it can come handy if you want to use a collection of modules that you have not “packaged” yet: in this case, you can put all modules in a folder and add it to <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/path/to/a/folder&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>But this will add the folder to the current session or script only. To add a folder permanently, you can use the <a class="reference external" href="https://docs.python.org/3/using/cmdline.html?highlight=pythonpath#envvar-PYTHONPATH">PYTHONPATH</a> environment variable.</p>
<div class="exercise admonition" id="week_03/01-Import-Scopes-exercise-4">
<p class="admonition-title"><span class="caption-number">Exercise 12 </span></p>
<div class="section" id="exercise-content">
<p>Print your own <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> on your laptop and explore the folders listed there.</p>
<p>Now let’s play with <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> a little. Create a fake module called <code class="docutils literal notranslate"><span class="pre">matplotlib.py</span></code> in your current working directory. Open a python interpreter and <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">matplotlib</span></code>. Which of the modules (the official or the fake one) is loaded by python, and why?</p>
</div>
</div><p>Because of this “feature”, it is important to find meaningful (and unique) names for your own modules (don’t forget to delete the fake <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> module after trying that out!).</p>
<p><em>Note: the “matplotlib trick” above does not work with modules of the standard library, because built-in modules are imported as part of the interpreter’s startup process.</em></p>
</div>
<div class="section" id="reimporting-modules">
<h2>Reimporting modules<a class="headerlink" href="#reimporting-modules" title="Permalink to this headline">¶</a></h2>
<p>Of course, there is a lot more behind an <code class="docutils literal notranslate"><span class="pre">import</span></code> statement than this short summary (see the <a class="reference external" href="https://docs.python.org/3/reference/simple_stmts.html#import">documentation</a> for a more comprehensive overview). What you should remember however is that an import statement is not computationally cheap: it has to look for a file among many folders, compile the python code to bytecode, add the module to a registry… Actually, for all the things it does, it is quite fast already!</p>
<p>Since <code class="docutils literal notranslate"><span class="pre">import</span></code> statements are used all the time in Python, it is a good idea to optimize them: therefore, Python will not re-import a module that is imported already.</p>
<p>Most of the time this is not a problem, but sometimes (mostly in interactive development) it might be useful to make changes to a module and having them available at the command line without having to restart a fresh Python interpreter each time. To do this, there are two mechanisms available to you:</p>
<ol class="simple">
<li><p>Using Python’s <a class="reference external" href="https://docs.python.org/3/library/importlib.html#importlib.reload">importlib.reload()</a> function:</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">importlib</span>
<span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">greetings</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;module &#39;greetings&#39; from &#39;/home/mowglie/disk/Dropbox/HomeDocs/git/scientific_programming/book/week_03/greetings.py&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>This can reimport a module which has been imported before (i.e. it won’t search for it again). But this has to be done <em>each time</em> you change a module, making it quite cumbersome in interactive mode. Here again, ipython comes with a more flexible solution:</p>
<ol class="simple">
<li><p>Using ipython’s <a class="reference external" href="https://ipython.readthedocs.io/en/stable/config/extensions/autoreload.html">autoreload</a> extension:</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
<p>From now on, <code class="docutils literal notranslate"><span class="pre">autoreload</span></code> will make sure that all modules are reloaded automatically before entering the execution of code typed at the ipython prompt.</p>
</div>
<div class="section" id="executing-modules-as-scripts">
<h2>Executing modules as scripts<a class="headerlink" href="#executing-modules-as-scripts" title="Permalink to this headline">¶</a></h2>
<p>You’ve already learned that importing modules actually <em>runs</em> them, the same way as <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">python</span> <span class="pre">mymodule.py</span></code> (from the linux terminal) or <code class="docutils literal notranslate"><span class="pre">%run</span> <span class="pre">mymodule.py</span></code> (in ipython) would. This can have some undesired consequences: what if, for example, you would like certain things to happen when the module is run as script but <em>not</em> when being imported?</p>
<p>There is a mechanism that allows to do exactly this. Add the following block of code at the end of the <code class="docutils literal notranslate"><span class="pre">greetings.py</span></code> module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># execute only if run as a script</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nargs</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">set_current_language</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">say_hi</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Syntax:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">un greetings.py name language&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Languages available: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">base</span><span class="p">)))</span>
    
</pre></div>
</div>
<p>Now you can execute your script like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> greetings.py Fabi fr
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Salut Fabi!
</pre></div>
</div>
</div>
</div>
<p>But importing it will produce no output:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">greetings</span>
</pre></div>
</div>
</div>
</div>
<p>How does this work exactly? The important bit is the <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__':</span></code> line. <code class="docutils literal notranslate"><span class="pre">__name__</span></code> (and all other attributes starting and ending with two underscores) is “reserved” by the language. They are no different than other variables, but you should not erase or replace them since they contain useful information and might be used by other tools. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">greetings</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># the documentation of the module as string</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A module to say hi in several langages.&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">greetings</span><span class="o">.</span><span class="vm">__name__</span>  <span class="c1"># the name of the module as string</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;greetings&#39;
</pre></div>
</div>
</div>
</div>
<p>Now, back to our script: the statement <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__'</span></code> is going to be false when the module is imported (since the name is <code class="docutils literal notranslate"><span class="pre">greetings</span></code>), but obviously true when the module is run as a script. Indeed, <code class="docutils literal notranslate"><span class="pre">__name__</span></code> is set to <code class="docutils literal notranslate"><span class="pre">__main__</span></code> when executed.</p>
</div>
<div class="section" id="take-home-points">
<h2>Take home points<a class="headerlink" href="#take-home-points" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>variables are defined in a <strong>scope</strong>, and we learned about two scopes: <strong>local</strong> and <strong>global</strong>. There are precise rules as to how each scope can interact with the other. As a general rule: global variables are available in nested scopes and cannot be overwritten (or can they?), and local variables are not available in the global scope.</p></li>
<li><p>the import mechanism is useful to avoid <strong>namespace pollution</strong>. Modules come with their own namespace, and it is recommended to keep each module’s namespace clean (i.e. no <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">XYZ</span> <span class="pre">import</span> <span class="pre">*</span></code>)</p></li>
<li><p>python borrowed the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> mechanism from linux and uses a similar logic to look for modules and packages. Installing a new module is therefore super easy: just put a <code class="docutils literal notranslate"><span class="pre">mymodule.py</span></code> at the right place. (and don’t mess with the existing modules!)</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">%autoreload</span></code> command from ipython allows to dynamically change a module while using it at the command line</p></li>
<li><p>when writing scripts, always put the code that needs to be executed in an <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__'</span></code> block: that way, your script can still be imported for the functions it proposes</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./week_03"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../week_02/Assignment-02.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Assignment #02</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="02-Strings-Paths.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">02 - String formatting and file paths</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Fabien Maussion<br/>
        
          <div class="extra_footer">
            <p>
<a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">
  <img align="right" class="margin" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by.svg" width="88px">
</a>
These lecture notes and exercises are licensed under a <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International (CC BY 4.0) license</a>.
<br>
&copy; Copyright 2018-2020.
</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>